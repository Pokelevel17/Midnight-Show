<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Midnight Swim</title>
<style>
  html,body {
    margin:0;
    padding:0;
    height:100%;
    background:#000;
    overflow:hidden;
    font-family:"Helvetica Neue",Arial,sans-serif;
    color:#fff;
  }
  #video-container {
    position:fixed;
    inset:0;
    background:#000;
    overflow:hidden;
  }
  iframe {
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    border:0;
    pointer-events:none;
  }
  .static {
    position:absolute;
    inset:0;
    background:url('https://upload.wikimedia.org/wikipedia/commons/d/d1/Static.gif') center/cover no-repeat;
    opacity:0;
    transition:opacity 1s ease;
    z-index:10;
  }
  .show {
    opacity:1 !important;
  }
  .title {
    position:absolute;
    top:16px;
    left:20px;
    z-index:20;
    text-shadow:-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000;
  }
  .title h1 {
    font-size:28px;
    margin:0;
    text-transform:uppercase;
    letter-spacing:2px;
  }
  .now-playing {
    margin-top:4px;
    font-size:14px;
    opacity:0.85;
  }
</style>
</head>
<body>
<div id="video-container"></div>
<div class="static" id="static"></div>

<div class="title">
  <h1>MIDNIGHT SWIM</h1>
  <div class="now-playing" id="nowText">Loading lineup...</div>
</div>

<script>
let playlist = [];
let titles = {};
let current = 0;

async function loadVideos() {
  try {
    const res = await fetch("Videos.json");
    const data = await res.json();
    playlist = shuffle(data.videos.map(v => v.id));
    data.videos.forEach(v => titles[v.id] = v.title || "Untitled");
    playNext();
  } catch (err) {
    console.error("Error loading videos:", err);
    document.getElementById("nowText").textContent = "Failed to load lineup.";
  }
}

// Shuffle playlist
function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function playNext() {
  const id = playlist[current];
  const now = document.getElementById("nowText");
  now.textContent = "Now Playing: " + (titles[id] || "Unknown");

  const container = document.getElementById("video-container");
  const iframe = document.createElement("iframe");
  iframe.src = `https://www.youtube.com/embed/${id}?autoplay=1&controls=0&rel=0&modestbranding=1&fs=0&playsinline=1&mute=0&enablejsapi=1`;
  container.innerHTML = "";
  container.appendChild(iframe);

  // Static fade transition
  const staticScreen = document.getElementById("static");
  staticScreen.classList.add("show");
  setTimeout(() => staticScreen.classList.remove("show"), 2000);

  // Play next after ~2 mins (you can adjust here)
  setTimeout(() => {
    staticScreen.classList.add("show");
    setTimeout(() => {
      current = (current + 1) % playlist.length;
      playNext();
    }, 2000);
  }, 120000); // 2 minutes per video for now
}

loadVideos();
</script>
</body>
</html>
