<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Midnight Channel</title>
<style>
:root {
  --bg:#000; --fg:#fff; --fade:800ms;
  font-family:"Helvetica Neue",Arial,sans-serif;
}
html,body {margin:0;height:100%;background:var(--bg);color:var(--fg);overflow:hidden;}
#videoPlayer {
  position:absolute;inset:0;width:100%;height:100%;object-fit:cover;
}
.overlay {
  position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
  background:#000;opacity:0;transition:opacity var(--fade) ease;z-index:10;
}
.overlay.show {opacity:1;}
.outlined {text-shadow:-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000;}
.bumper-text{text-align:center;}
.bumper-text h1{font-size:40px;margin:0;text-transform:uppercase;}
.bumper-text p{margin:8px 0 0;font-size:14px;opacity:0.85;}
.title {
  position:absolute;top:16px;left:20px;z-index:20;
}
.title h1{font-size:28px;margin:0;text-transform:uppercase;letter-spacing:2px;}
.now-playing{margin-top:4px;font-size:14px;opacity:0.85;}
.controls {
  position:absolute;right:20px;bottom:20px;z-index:20;display:flex;gap:10px;
}
.btn{background:transparent;color:#fff;border:1px solid #444;border-radius:6px;padding:6px 10px;cursor:pointer;font-size:14px;transition:background 0.2s;}
.btn:hover{background:rgba(255,255,255,0.1);}
</style>
</head>
<body>

<video id="videoPlayer" autoplay muted playsinline></video>

<div class="overlay" id="overlay">
  <div class="bumper-text outlined">
    <h1 id="bumpLine">PLEASE STAND BY</h1>
    <p id="bumpSub">MIDNIGHT CHANNEL</p>
  </div>
</div>

<div class="title outlined">
  <h1>MIDNIGHT SWIM</h1>
  <div class="now-playing" id="nowText">Loading lineup...</div>
</div>

<div class="controls">
  <button class="btn outlined" id="pauseBtn">❚❚</button>
  <button class="btn outlined" id="fsBtn">⛶</button>
</div>

<script>
const bumpers=[
  {line:"PLEASE STAND BY",sub:"transmission will resume shortly"},
  {line:"INTERMISSION",sub:"take a break — we’ll be right back"},
  {line:"NO SIGNAL",sub:"please stand by"},
  {line:"THANK YOU",sub:"for staying up this late"}
];

let playlist=[],titles={},current=0,paused=false;
const videoPlayer=document.getElementById("videoPlayer");

// Load videos.json
async function loadVideos(){
  const res=await fetch("Videos.json");
  const data=await res.json();
  playlist=shuffle(data.videos.map(v=>v.url));
  data.videos.forEach(v=>titles[v.url]=v.title||"Untitled");
  playVideo();
}

// Shuffle helper
function shuffle(array){
  for(let i=array.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [array[i],array[j]]=[array[j],array[i]];
  }
  return array;
}

// Play video
function playVideo(){
  if(!playlist.length) return;
  const url=playlist[current];
  videoPlayer.src=url;
  videoPlayer.play().catch(e=>console.log(e));
  document.getElementById("nowText").textContent="Now Playing: "+(titles[url]||"Unknown");
}

// When video ends, show bumper and next video
videoPlayer.onended=function(){
  showBumper();
};

function showBumper(delay=0){
  const b=bumpers[Math.floor(Math.random()*bumpers.length)];
  document.getElementById("bumpLine").textContent=b.line;
  document.getElementById("bumpSub").textContent=b.sub;
  const overlay=document.getElementById("overlay");
  overlay.classList.add("show");
  setTimeout(()=>{
    current=(current+1)%playlist.length;
    playVideo();
    overlay.classList.remove("show");
  },delay+5000);
}

document.getElementById("pauseBtn").onclick=()=>{
  if(paused){videoPlayer.play();paused=false;pauseBtn.textContent="❚❚";}
  else{videoPlayer.pause();paused=true;pauseBtn.textContent="▶";}
};

document.getElementById("fsBtn").onclick=()=>{
  if(!document.fullscreenElement) document.body.requestFullscreen();
  else document.exitFullscreen();
};

loadVideos();
</script>
</body>
</html>
